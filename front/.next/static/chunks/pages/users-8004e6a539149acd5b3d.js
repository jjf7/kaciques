_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[15],{NhoZ:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return J}));var n=r("o0o1"),a=r.n(n),c=r("nKUr"),s=r("HaE+"),o=r("q1tI"),i=r.n(o),l=r("5Yp1"),u=r("KQm4"),d=r("rePB"),j=r("ODXe"),b=r("h4VS"),p=r("vOnD"),O=r("d76Q"),h=r.n(O),m=r("zM5D"),x=r("cWnB"),f=r("QojX"),g=r("3Z9Z"),v=r("JI6e"),y=r("jDKy"),C=r("20a2"),k=r("5qq8");function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){Object(d.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(){var e=Object(b.a)(["\n  border-top-left-radius: 0;\n  border-bottom-left-radius: 0;\n  border-top-right-radius: 5px;\n  border-bottom-right-radius: 5px;\n        columns={columns}\n  height: 34px;\n  width: 32px;\n  text-align: center;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"]);return S=function(){return e},e}function P(){var e=Object(b.a)(["\n  height: 32px;\n  width: 200px;\n  border-radius: 3px;\n  border-top-left-radius: 5px;\n  border-bottom-left-radius: 5px;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  border: 1px solid #e5e5e5;\n  padding: 0 32px 0 16px;\n\n  &:hover {\n    cursor: pointer;\n  }\n"]);return P=function(){return e},e}var _=p.default.input(P()),F=Object(p.default)(x.a)(S()),T=function(e){var t=e.filterText,r=e.onFilter,n=e.onClear;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(_,{id:"search",type:"text",placeholder:"Introduzca el nombre del usuario a buscar","aria-label":"Search Input",value:t,onChange:r}),Object(c.jsx)(F,{type:"button",onClick:n,children:"X"})]})},E=function(e){var t=e.columns,r=e.data,n=e.setMsg,l=Object(C.useRouter)(),d=Object(o.useState)(!1),b=d[0],p=d[1],O=Object(o.useState)(""),w=O[0],S=O[1],P=Object(o.useState)(""),_=P[0],F=P[1],E=Object(o.useState)(!1),D=E[0],q=E[1],z=i.a.useState(""),J=Object(j.a)(z,2),L=J[0],H=J[1],I=Object(o.useState)(!1),R=I[0],B=I[1],G={id:"",id_role:"",role:"",username:"",email:"",password:""},U=Object(o.useState)(G),M=U[0],V=U[1],X=function(){return p(!1)},Z=function(){return q(!1)},A=i.a.useState(!1),K=Object(j.a)(A,2),Q=K[0],W=K[1],Y=r.filter((function(e){return e.username&&e.username.toLowerCase().includes(L.toLowerCase())})),$=i.a.useMemo((function(){return Object(c.jsx)(T,{onFilter:function(e){return H(e.target.value)},onClear:function(){L&&(W(!Q),H(""))},filterText:L})}),[L,Q]),ee=function(e){V(N(N({},M),{},{id:e.id,id_role:e.id_role,role:e.role,username:e.username,email:e.email,password:e.password})),p(!0)},te=function(e){S(e.id),q(!0)},re=function(){var e=Object(s.a)(a.a.mark((function e(t){var r,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=JSON.parse(Object(k.a)(l)),!1!==t.currentTarget.checkValidity()){e.next=7;break}t.preventDefault(),t.stopPropagation(),e.next=15;break;case 7:return B(!0),e.next=10,fetch("http://localhost:3001/users/change/pass/".concat(w),{method:"PUT",headers:{"Content-Type":"application/json","x-access-token":r.token},body:JSON.stringify({password:_})});case 10:return c=e.sent,e.next=13,c.json();case 13:"success"==(s=e.sent)?(n({status:1,msg:"Se ha editado modificado la contrasena correctamente"}),Z(),V(G)):n({status:2,msg:s});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(s.a)(a.a.mark((function e(t){var r,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=JSON.parse(Object(k.a)(l)),!1!==t.currentTarget.checkValidity()){e.next=7;break}t.preventDefault(),t.stopPropagation(),e.next=15;break;case 7:return B(!0),e.next=10,fetch("http://localhost:3001/users/".concat(M.id),{method:"PUT",headers:{"Content-Type":"application/json","x-access-token":r.token},body:JSON.stringify({username:M.username,email:M.email,roles:M.id_role})});case 10:return c=e.sent,e.next=13,c.json();case 13:"success"==(s=e.sent)?(n({status:1,msg:"Se ha editado correctamente el usuario"}),p(!1),V(G)):n({status:2,msg:s});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(s.a)(a.a.mark((function e(t){var r,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=JSON.parse(Object(k.a)(l)),!confirm("Estas seguro de eliminar el usuario?")){e.next=13;break}return e.next=4,fetch("http://localhost:3001/users/".concat(t.id),{method:"DELETE",headers:{"Content-Type":"application/json","x-access-token":r.token}});case 4:return c=e.sent,console.log(c),e.next=8,c.json();case 8:s=e.sent,console.log("response:",s),n("success"==s?{status:1,msg:"Se ha eliminado correctamente el usuario"}:{status:1,msg:"Ha ocurrido un error"}),e.next=13;break;case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=t.map((function(e){return e})),se=Object(o.useCallback)((function(){return[].concat(Object(u.a)(ce),[{name:"Acciones",allowOverflow:!0,right:!0,minWidth:"200px",cell:function(e){return Object(c.jsxs)("div",{children:[Object(c.jsx)("button",{title:"Editar usuario",className:"btn btn-warning btn-sm",type:"button",onClick:function(){return ee(e)},style:{backgroundColor:"aliceblue"},children:Object(c.jsx)("i",{className:"fi-rr-edit"})}),Object(c.jsx)("button",{title:"Cambiar contrasena",className:"btn btn-warning btn-sm ml-2 text-info",type:"button",onClick:function(){return te(e)},style:{backgroundColor:"aliceblue"},children:Object(c.jsx)("i",{className:"fi-rr-eye"})}),Object(c.jsx)("button",{title:"Eliminar usuario",className:"btn btn-danger btn-sm ml-2 text-danger",type:"button",onClick:function(){return ae(e)},style:{backgroundColor:"aliceblue"},children:Object(c.jsx)("i",{className:"fi-rr-trash"})})]})}}])}),[ce]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(h.a,{columns:se(),data:Y,defaultSortField:"username",pagination:!0,paginationPerPage:5,paginationResetDefaultPage:Q,subHeader:!0,subHeaderComponent:$,persistTableHead:!0}),Object(c.jsxs)(m.a,{size:"lg",show:b,onHide:X,children:[Object(c.jsx)(m.a.Header,{closeButton:!0,children:Object(c.jsx)(m.a.Title,{children:"Editar usuario"})}),Object(c.jsx)(m.a.Body,{children:Object(c.jsxs)(f.a,{validated:R,children:[Object(c.jsxs)(f.a.Group,{as:g.a,children:[Object(c.jsx)(f.a.Label,{column:!0,sm:3,children:"Rol"}),Object(c.jsxs)(v.a,{sm:9,children:[Object(c.jsxs)(f.a.Control,{onChange:function(e){V(N(N({},M),{},{id_role:e.target.value}))},name:"id_role",id:"id_role",required:!0,as:"select",value:M.id_role,children:[Object(c.jsx)("option",{value:"6079ab4c3c6b1e091c985626",children:"Admin"}),Object(c.jsx)("option",{value:"6079ab4c3c6b1e091c985625",children:"User"})]}),Object(c.jsx)(f.a.Control.Feedback,{children:"Correcto!"}),Object(c.jsx)(f.a.Control.Feedback,{type:"invalid",children:"Seleccione un rol"})]})]}),Object(c.jsxs)(f.a.Group,{as:g.a,style:{marginTop:"30px"},children:[Object(c.jsx)(f.a.Label,{column:!0,sm:3,children:"Nombre"}),Object(c.jsxs)(v.a,{sm:9,children:[Object(c.jsx)(y.a,{onChange:function(e){V(N(N({},M),{},{username:e.target.value}))},name:"username",id:"username",required:!0,value:M.username,type:"text",placeholder:"Nombre"}),Object(c.jsx)(f.a.Control.Feedback,{children:"Correcto!"}),Object(c.jsx)(f.a.Control.Feedback,{type:"invalid",children:"Introduzca el nombre del usuario"})]})]}),Object(c.jsxs)(f.a.Group,{as:g.a,style:{marginTop:"30px"},children:[Object(c.jsx)(f.a.Label,{column:!0,sm:3,children:"Email"}),Object(c.jsxs)(v.a,{sm:9,children:[Object(c.jsx)(y.a,{onChange:function(e){V(N(N({},M),{},{email:e.target.value}))},name:"email",id:"email",required:!0,value:M.email,type:"text",placeholder:"Nombre"}),Object(c.jsx)(f.a.Control.Feedback,{children:"Correcto!"}),Object(c.jsx)(f.a.Control.Feedback,{type:"invalid",children:"Introduzca el email"})]})]})]})}),Object(c.jsxs)(m.a.Footer,{children:[Object(c.jsx)(x.a,{variant:"secondary",onClick:X,children:"Cerrar"}),Object(c.jsx)(x.a,{variant:"primary",onClick:ne,children:"Editar usuario"})]})]}),Object(c.jsxs)(m.a,{size:"lg",show:D,onHide:Z,children:[Object(c.jsx)(m.a.Header,{closeButton:!0,children:Object(c.jsx)(m.a.Title,{children:"Cambiar Contrase\xf1a"})}),Object(c.jsx)(m.a.Body,{children:Object(c.jsx)(f.a,{validated:R,children:Object(c.jsxs)(f.a.Group,{as:g.a,style:{marginTop:"30px"},children:[Object(c.jsx)(f.a.Label,{column:!0,sm:3,children:"Introduzca la nueva contrase\xf1a"}),Object(c.jsxs)(v.a,{sm:9,children:[Object(c.jsx)(y.a,{onChange:function(e){F(e.target.value)},name:"email",id:"email",required:!0,value:_,type:"password",placeholder:"Contrasena"}),Object(c.jsx)(f.a.Control.Feedback,{children:"Correcto!"}),Object(c.jsx)(f.a.Control.Feedback,{type:"invalid",children:"Introduzca la contrasena"})]})]})})}),Object(c.jsxs)(m.a.Footer,{children:[Object(c.jsx)(x.a,{variant:"secondary",onClick:Z,children:"Cerrar"}),Object(c.jsx)(x.a,{variant:"primary",onClick:re,children:"Editar contrasena"})]})]})]})};r("YFqc");function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){Object(d.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e){var t=e.setMsg,r=Object(C.useRouter)(),n=Object(o.useState)(!1),i=n[0],l=n[1],u=Object(o.useState)(!1),d=u[0],j=u[1],b={id:"",id_role:"",username:"",email:"",password:""},p=Object(o.useState)(b),O=p[0],h=p[1],w=function(){var e=Object(s.a)(a.a.mark((function e(n){var c,s,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=JSON.parse(Object(k.a)(r)),!1!==n.currentTarget.checkValidity()){e.next=7;break}n.preventDefault(),n.stopPropagation(),e.next=16;break;case 7:return j(!0),e.next=10,fetch("http://localhost:3001/users",{method:"POST",headers:{"Content-Type":"application/json","x-access-token":c.token},body:JSON.stringify({username:O.username,email:O.email,password:O.password,roles:O.id_role})});case 10:return s=e.sent,e.next=13,s.json();case 13:o=e.sent,console.log(o),"success"==o?(t({status:1,msg:"Se ha agregado correctamente el nuevo usuario"}),l(!1),h(b)):t({status:2,msg:"Rellene el formulario"});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){return l(!1)};return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(x.a,{variant:"info",onClick:function(){return l(!0)},children:"Nuevo Usuario"}),Object(c.jsxs)(m.a,{size:"lg",show:i,onHide:N,children:[Object(c.jsx)(m.a.Header,{closeButton:!0,children:Object(c.jsx)(m.a.Title,{children:"Nuevo usuario"})}),Object(c.jsx)(m.a.Body,{children:Object(c.jsxs)(f.a,{validated:d,children:[Object(c.jsxs)(f.a.Group,{as:g.a,children:[Object(c.jsx)(f.a.Label,{column:!0,sm:3,children:"Rol"}),Object(c.jsxs)(v.a,{sm:9,children:[Object(c.jsxs)(f.a.Control,{onChange:function(e){h(q(q({},O),{},{id_role:e.target.value}))},name:"id_role",id:"id_role",required:!0,as:"select",defaultValue:"Seleccionar...",children:[Object(c.jsx)("option",{value:"",children:"Seleccionar..."}),Object(c.jsx)("option",{value:"admin",children:"Admin"}),Object(c.jsx)("option",{value:"user",children:"User"})]}),Object(c.jsx)(f.a.Control.Feedback,{children:"Correcto!"}),Object(c.jsx)(f.a.Control.Feedback,{type:"invalid",children:"Seleccione un rol"})]})]}),Object(c.jsxs)(f.a.Group,{as:g.a,style:{marginTop:"30px"},children:[Object(c.jsx)(f.a.Label,{column:!0,sm:3,children:"Nombre"}),Object(c.jsxs)(v.a,{sm:9,children:[Object(c.jsx)(y.a,{onChange:function(e){h(q(q({},O),{},{username:e.target.value}))},name:"username",id:"username",required:!0,value:O.username,type:"text",placeholder:"Nombre"}),Object(c.jsx)(f.a.Control.Feedback,{children:"Correcto!"}),Object(c.jsx)(f.a.Control.Feedback,{type:"invalid",children:"Introduzca el nombre del usuario"})]})]}),Object(c.jsxs)(f.a.Group,{as:g.a,style:{marginTop:"30px"},children:[Object(c.jsx)(f.a.Label,{column:!0,sm:3,children:"Email"}),Object(c.jsxs)(v.a,{sm:9,children:[Object(c.jsx)(y.a,{onChange:function(e){h(q(q({},O),{},{email:e.target.value}))},name:"email",id:"email",required:!0,value:O.email,type:"text",placeholder:"Nombre"}),Object(c.jsx)(f.a.Control.Feedback,{children:"Correcto!"}),Object(c.jsx)(f.a.Control.Feedback,{type:"invalid",children:"Introduzca el email"})]})]}),Object(c.jsxs)(f.a.Group,{as:g.a,style:{marginTop:"30px"},children:[Object(c.jsx)(f.a.Label,{column:!0,sm:3,children:"Contrase\xf1a"}),Object(c.jsxs)(v.a,{sm:9,children:[Object(c.jsx)(y.a,{onChange:function(e){h(q(q({},O),{},{password:e.target.value}))},name:"password",id:"password",required:!0,value:O.password,type:"password"}),Object(c.jsx)(f.a.Control.Feedback,{children:"Correcto!"}),Object(c.jsx)(f.a.Control.Feedback,{type:"invalid",children:"Introduzca la contrase\xf1a"})]})]})]})}),Object(c.jsxs)(m.a.Footer,{children:[Object(c.jsx)(x.a,{variant:"secondary",onClick:N,children:"Cerrar"}),Object(c.jsx)(x.a,{variant:"primary",onClick:w,children:"Guardar usuario"})]})]})]})}function J(){var e=Object(C.useRouter)(),t=Object(o.useState)(""),r=t[0],n=t[1],i=Object(o.useState)([]),u=i[0],d=i[1];function j(){return(j=Object(s.a)(a.a.mark((function t(){var r,n,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=JSON.parse(Object(k.a)(e)),t.next=3,fetch("http://localhost:3001/users",{headers:{"Content-Type":"application/json","x-access-token":r.token}});case 3:return n=t.sent,t.next=6,n.json();case 6:c=t.sent,console.log(c),d(c);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(o.useEffect)((function(){"user"===JSON.parse(Object(k.a)(e)).role&&e.push("/dashboard"),function(){j.apply(this,arguments)}()}),[r]);return Object(c.jsxs)(l.a,{children:[Object(c.jsx)("h4",{className:"title-h1",children:"Listado de Usuarios"}),r?1==r.status?Object(c.jsxs)("div",{className:"alert alert-success",role:"alert",children:[Object(c.jsx)("i",{className:"fi-rr-check"}),r.msg]}):Object(c.jsx)("div",{className:"alert alert-danger",role:"alert",children:r.msg}):"",Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("div",{className:"containerButtons",children:Object(c.jsx)(z,{setMsg:n})}),Object(c.jsx)(E,{setMsg:n,className:"mt-5",columns:[{name:"id",selector:"_id",omit:!0},{name:"id_role",selector:"id_role",omit:!0},{name:"Rol",selector:"role",sortable:!0,editable:!0},{name:"Nombre",selector:"username",sortable:!0,editable:!0},{name:"Email",selector:"email",sortable:!0,editable:!0}],data:u})]})]})}},URgp:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users",function(){return r("NhoZ")}])}},[["URgp",0,2,1,3,4,5]]]);